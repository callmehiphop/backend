/*!
 * backend.js - v0.0.2
 * github.com/callmehiphop/backend.js
 */
!function(a,b){"use strict";"function"==typeof define&&define.amd?define(b):"undefined"!=typeof module&&module.exports?module.exports=b():a.backend=b()}(this,function(a){"use strict";var b="undefined"!=typeof window?window:"undefined"!=typeof self?self:this,c=Array.prototype.slice,d=function(a,b,c){for(var d=0;d<a.length&&b.call(c||this,a[d],d,a)!==!1;d++);},e=function(a){return d(c.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},f=function(a,b){var c={};for(var d in a)l(a[d])||b&&!a[d]||(c[d]=a[d]);return c},g=function(a){var b=[];for(var c in a)b.push(c);return b},h=function(a,b){var c=a.slice(0);return d(b,function(a){~c.indexOf(a)||c.push(a)}),c.sort()},i=function(a,b){if(!m(a))return a===b;var c=h(g(a),g(b)),e=!0;return d(c,function(c){return a[c]===b[c]||(m(a[c])||m(b[c]))&&i(a[c],b[c])?void 0:(e=!1,!1)}),e},j=function(a,b){for(var c in b)if(a[c]!==b[c])return!1;return!0},k=function(a){return function(b){return typeof b===a}},l=k("function"),m=k("object"),n=k("number"),o=k("string"),p=function(a){var b="";for(var c in a)b+=c+"="+a[c]+"&";return b.slice(0,-1)},q=function(a){var b={};return a.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(a,c,d,e){b[c]=e}),b},r=[],s=function(a,b,c,d){this.method=a.toUpperCase(),this.url=b instanceof RegExp?b:x(b),this.data=c,this.headers=d};e(s.prototype,{match:function(a,b,c,d){return this.url.test(b)&&this.method===a.toUpperCase()&&(!this.headers||j(d,this.headers))&&i(this.data,c)?!0:!1}});var t=/\((.*?)\)/g,u=/(\(\?)?:\w+/g,v=/\*\w+/g,w=/[\-{}\[\]+?.,\\\^$|#\s]/g,x=function(a){return a=a.replace(w,"\\$&").replace(t,"(?:$1)?").replace(u,function(a,b){return b?a:"([^/]+)"}).replace(v,"(.*?)"),new RegExp("^"+a+"$")},y=b.XMLHttpRequest,z=function(){return y?new y:b.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):void 0};b.XMLHttpRequest=function(){var b,c,h={headers:{}};e(this,{onabort:null,onerror:null,onload:null,onloadend:null,onloadstart:null,onprogress:null,onreadystatechange:null,readyState:0,response:"",responseText:"",responseType:"",responseXML:null,status:0,statusText:"",withCredentials:!1,open:function(a,b,c,d,e){h.method=a,h.url=b,h.async=c,h.username=d,h.password=e},send:function(i){var j,k;if(i=i||a,j=o(i)?q(i):i,d(r,function(a){return a.match(h.method,h.url,j,h.headers)?(k=a,!1):void 0}),k){var n=k.response.data;m(n)&&(n=JSON.stringify(n)),e(this,{readyState:4,status:k.response.status,response:n,responseText:n}),b=k.response.headers||{},l(this.onreadystatechange)&&this.onreadystatechange()}else{var p=this;c=z(),c.open(h.method,h.url,h.async,h.username,h.password),c.onreadystatechange=function(){e(p,f(this,!0)),l(p.onreadystatechange)&&p.onreadystatechange()},d(g(h.headers),function(a){this.setRequestHeader(a,h.headers[a])},c),c.send(i)}},setRequestHeader:function(a,b){h.headers[a]=b},getResponseHeader:function(a){return c?c.getResponseHeader(a):b[a]},getAllResponseHeaders:function(){return c?c.getAllResponseHeaders():p(b)},abort:function(){c&&c.abort()}})};var A={};A.when=function(a,b,c,d){var e=new s(a,b,c,d);return r.push(e),{respond:function(a,b,c){e.response=B(a,b,c)}}},A.clear=function(){r.length=0};var B=function(a,b,c){return n(a)?{status:a,data:b,headers:c}:{status:200,data:a,headers:b}};return d(["get","delete","jsonp"],function(b){A[b]=function(c,d){return A.when(b,c,a,d)}}),d(["put","post","patch"],function(a){A[a]=function(b,c,d){return A.when(a,b,c,d)}}),String.prototype.on=function(a,b,c){return A.when(a,this,b,c)},A});
//# sourceMappingURL=backend.js.map